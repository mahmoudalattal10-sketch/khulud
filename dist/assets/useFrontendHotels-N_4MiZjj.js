import{c as m,r as o,H as L}from"./index-BnuycFB_.js";/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=m("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=m("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=m("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=m("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),z=["مكة المكرمة","المدينة المنورة"],U=[{name:"المملكة العربية السعودية",code:"SA",cities:["جدة","الرياض","الدمام","الخبر"]},{name:"الإمارات العربية المتحدة",code:"AE",cities:["دبي","أبوظبي","الشارقة","رأس الخيمة"]},{name:"قطر",code:"QA",cities:["الدوحة","الوكرة","الخور"]},{name:"الكويت",code:"KW",cities:["الكويت العاصمة","السالمية","الجهراء"]},{name:"البحرين",code:"BH",cities:["المنامة","المحرق","الرفاع"]},{name:"عمان",code:"OM",cities:["مسقط","صلالة","صحار"]},{name:"مصر",code:"EG",cities:["القاهرة","الغردقة","شرم الشيخ","الإسكندرية","مرسى علم"]},{name:"الأردن",code:"JO",cities:["عمان","العقبة","البحر الميت"]}],F={city:null,maxPrice:1e4,minRating:0,starRatings:[],maxDistance:[],hasOffer:!1,hasFreeBreakfast:!1,hasFreeTransport:!1,amenities:[]},R={field:"rating",direction:"desc"},w=r=>{if(!r)return 9999;if(r.includes("صف أول")||r.includes("مباشر"))return 0;const n=r.match(/(\d+)/);return n?parseInt(n[0]):9999},K=(r,n)=>{const[f,H]=o.useState([]),[I,E]=o.useState(!0),[b,h]=o.useState(null),[c,g]=o.useState({...F,city:r}),[k,S]=o.useState(R),[p,T]=o.useState(""),M=o.useCallback(async()=>{E(!0),h(null);try{const t={};r&&r!=="all"&&(t.city=r),n!=null&&n.checkIn&&(t.checkIn=n.checkIn),n!=null&&n.checkOut&&(t.checkOut=n.checkOut),n!=null&&n.guests&&(t.guests=n.guests);const e=await L.getAll(t);e.success&&e.data?H(e.data):h(e.error||"فشل في تحميل الفنادق")}catch{h("حدث خطأ في الاتصال بالخادم")}finally{E(!1)}},[r,n==null?void 0:n.checkIn,n==null?void 0:n.checkOut,n==null?void 0:n.guests]);o.useEffect(()=>{M()},[M]),o.useEffect(()=>{r!==void 0&&g(t=>({...t,city:r}))},[r]);const D=o.useCallback((t,e)=>{g(i=>({...i,[t]:e}))},[]),O=o.useCallback(()=>{g(F),S(R),T("")},[]),v=o.useMemo(()=>{let t=[...f].filter(e=>e&&e.basePrice!=null&&!isNaN(Number(e.basePrice)));if(p.trim()){const e=s=>s.toLowerCase().replace(/ة/g,"ه").replace(/أ|إ|آ/g,"ا").trim(),i=e(p);t=t.filter(s=>e(s.name).includes(i)||e(s.nameEn||"").includes(i)||e(s.location).includes(i)||e(s.description||"").includes(i))}if(c.city&&c.city!=="all"){const e=String(c.city).toLowerCase().trim(),i=["مكة","makkah","مكه","makka"],s=["المدينة","madinah","المدينه","مدينة","madina"],l=["جدة","jeddah","جده"],y=["الرياض","riyadh","riyad"];t=t.filter(A=>{const a=(A.city||"").toLowerCase(),d=(A.location||"").toLowerCase();return i.includes(e)||e==="makkah"?i.some(u=>a.includes(u)||d.includes(u)):s.includes(e)||e==="madinah"?s.some(u=>a.includes(u)||d.includes(u)):l.includes(e)?l.some(u=>a.includes(u)||d.includes(u)):y.includes(e)?y.some(u=>a.includes(u)||d.includes(u)):a.includes(e)||d.includes(e)})}return c.maxPrice&&(t=t.filter(e=>e.basePrice<=c.maxPrice)),c.minRating&&c.minRating>0&&(t=t.filter(e=>e.rating>=c.minRating)),c.starRatings&&c.starRatings.length>0&&(t=t.filter(e=>c.starRatings.some(i=>i===5?e.rating>=4.5:i===4?e.rating>=4&&e.rating<4.5:i===3?e.rating<4:!1))),c.maxDistance&&c.maxDistance.length>0&&(t=t.filter(e=>{const i=w(e.distanceFromHaram);return c.maxDistance.some(s=>{if(s===0){const l=e.view&&e.view.trim()!==""&&e.view!=="بدون إطلالة"&&e.view!=="No View";return i===0||l}return i>0&&i<=s})})),c.hasOffer&&(t=t.filter(e=>e.isOffer)),c.hasFreeBreakfast&&(t=t.filter(e=>e.hasFreeBreakfast)),c.hasFreeTransport&&(t=t.filter(e=>e.hasFreeTransport)),c.amenities&&c.amenities.length>0&&(t=t.filter(e=>c.amenities.every(i=>{var s;return(s=e.amenities)==null?void 0:s.includes(i)}))),t.sort((e,i)=>{let s=0;switch(k.field){case"price":s=e.basePrice-i.basePrice;break;case"rating":s=e.rating-i.rating;break;case"distance":s=w(e.distanceFromHaram)-w(i.distanceFromHaram);break;case"reviews":s=e.reviews-i.reviews;break;case"smart":const l=e.rating*1e3/e.basePrice,y=i.rating*1e3/i.basePrice;s=l-y;break}return k.direction==="desc"?-s:s}),t},[f,c,k,p]);return{hotels:f,filteredHotels:v,loading:I,error:b,refetch:M,filters:c,setFilters:g,applyFilter:D,resetFilters:O,sortBy:k,setSortBy:S,searchQuery:p,setSearchQuery:T,totalCount:f.length,filteredCount:v.length}};export{B,C,U as D,_ as M,z as T,N as a,K as u};
